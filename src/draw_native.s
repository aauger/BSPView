.globl vline_native_dither, vline_native_dither_skip

vline_native_dither:
	| vline_native_dither(u8* buf, s16 dy, u8 col1, u8 col2)
	move.l 4(%sp), %a0		| load pointer
	moveq.l #0, %d0
	move.w #159, %d0
	sub.w 10(%sp), %d0		| d0 is 159-dy
	move.b 15(%sp), %d1 	| load color 1
	move.l %d2, -(%sp)
	move.b 4+19(%sp), %d2		| load color 2
	lsl.w #2, %d0
	jmp dither_draw_table(%pc, %d0.W)

dither_draw_table:	
	move.b %d2, 636(%a0)
    move.b %d1, 632(%a0)
    move.b %d2, 628(%a0)
    move.b %d1, 624(%a0)
    move.b %d2, 620(%a0)
    move.b %d1, 616(%a0)
    move.b %d2, 612(%a0)
    move.b %d1, 608(%a0)
    move.b %d2, 604(%a0)
    move.b %d1, 600(%a0)
    move.b %d2, 596(%a0)
    move.b %d1, 592(%a0)
    move.b %d2, 588(%a0)
    move.b %d1, 584(%a0)
    move.b %d2, 580(%a0)
    move.b %d1, 576(%a0)
    move.b %d2, 572(%a0)
    move.b %d1, 568(%a0)
    move.b %d2, 564(%a0)
    move.b %d1, 560(%a0)
    move.b %d2, 556(%a0)
    move.b %d1, 552(%a0)
    move.b %d2, 548(%a0)
    move.b %d1, 544(%a0)
    move.b %d2, 540(%a0)
    move.b %d1, 536(%a0)
    move.b %d2, 532(%a0)
    move.b %d1, 528(%a0)
    move.b %d2, 524(%a0)
    move.b %d1, 520(%a0)
    move.b %d2, 516(%a0)
    move.b %d1, 512(%a0)
    move.b %d2, 508(%a0)
    move.b %d1, 504(%a0)
    move.b %d2, 500(%a0)
    move.b %d1, 496(%a0)
    move.b %d2, 492(%a0)
    move.b %d1, 488(%a0)
    move.b %d2, 484(%a0)
    move.b %d1, 480(%a0)
    move.b %d2, 476(%a0)
    move.b %d1, 472(%a0)
    move.b %d2, 468(%a0)
    move.b %d1, 464(%a0)
    move.b %d2, 460(%a0)
    move.b %d1, 456(%a0)
    move.b %d2, 452(%a0)
    move.b %d1, 448(%a0)
    move.b %d2, 444(%a0)
    move.b %d1, 440(%a0)
    move.b %d2, 436(%a0)
    move.b %d1, 432(%a0)
    move.b %d2, 428(%a0)
    move.b %d1, 424(%a0)
    move.b %d2, 420(%a0)
    move.b %d1, 416(%a0)
    move.b %d2, 412(%a0)
    move.b %d1, 408(%a0)
    move.b %d2, 404(%a0)
    move.b %d1, 400(%a0)
    move.b %d2, 396(%a0)
    move.b %d1, 392(%a0)
    move.b %d2, 388(%a0)
    move.b %d1, 384(%a0)
    move.b %d2, 380(%a0)
    move.b %d1, 376(%a0)
    move.b %d2, 372(%a0)
    move.b %d1, 368(%a0)
    move.b %d2, 364(%a0)
    move.b %d1, 360(%a0)
    move.b %d2, 356(%a0)
    move.b %d1, 352(%a0)
    move.b %d2, 348(%a0)
    move.b %d1, 344(%a0)
    move.b %d2, 340(%a0)
    move.b %d1, 336(%a0)
    move.b %d2, 332(%a0)
    move.b %d1, 328(%a0)
    move.b %d2, 324(%a0)
    move.b %d1, 320(%a0)
    move.b %d2, 316(%a0)
    move.b %d1, 312(%a0)
    move.b %d2, 308(%a0)
    move.b %d1, 304(%a0)
    move.b %d2, 300(%a0)
    move.b %d1, 296(%a0)
    move.b %d2, 292(%a0)
    move.b %d1, 288(%a0)
    move.b %d2, 284(%a0)
    move.b %d1, 280(%a0)
    move.b %d2, 276(%a0)
    move.b %d1, 272(%a0)
    move.b %d2, 268(%a0)
    move.b %d1, 264(%a0)
    move.b %d2, 260(%a0)
    move.b %d1, 256(%a0)
    move.b %d2, 252(%a0)
    move.b %d1, 248(%a0)
    move.b %d2, 244(%a0)
    move.b %d1, 240(%a0)
    move.b %d2, 236(%a0)
    move.b %d1, 232(%a0)
    move.b %d2, 228(%a0)
    move.b %d1, 224(%a0)
    move.b %d2, 220(%a0)
    move.b %d1, 216(%a0)
    move.b %d2, 212(%a0)
    move.b %d1, 208(%a0)
    move.b %d2, 204(%a0)
    move.b %d1, 200(%a0)
    move.b %d2, 196(%a0)
    move.b %d1, 192(%a0)
    move.b %d2, 188(%a0)
    move.b %d1, 184(%a0)
    move.b %d2, 180(%a0)
    move.b %d1, 176(%a0)
    move.b %d2, 172(%a0)
    move.b %d1, 168(%a0)
    move.b %d2, 164(%a0)
    move.b %d1, 160(%a0)
    move.b %d2, 156(%a0)
    move.b %d1, 152(%a0)
    move.b %d2, 148(%a0)
    move.b %d1, 144(%a0)
    move.b %d2, 140(%a0)
    move.b %d1, 136(%a0)
    move.b %d2, 132(%a0)
    move.b %d1, 128(%a0)
    move.b %d2, 124(%a0)
    move.b %d1, 120(%a0)
    move.b %d2, 116(%a0)
    move.b %d1, 112(%a0)
    move.b %d2, 108(%a0)
    move.b %d1, 104(%a0)
    move.b %d2, 100(%a0)
    move.b %d1, 96(%a0)
    move.b %d2, 92(%a0)
    move.b %d1, 88(%a0)
    move.b %d2, 84(%a0)
    move.b %d1, 80(%a0)
    move.b %d2, 76(%a0)
    move.b %d1, 72(%a0)
    move.b %d2, 68(%a0)
    move.b %d1, 64(%a0)
    move.b %d2, 60(%a0)
    move.b %d1, 56(%a0)
    move.b %d2, 52(%a0)
    move.b %d1, 48(%a0)
    move.b %d2, 44(%a0)
    move.b %d1, 40(%a0)
    move.b %d2, 36(%a0)
    move.b %d1, 32(%a0)
    move.b %d2, 28(%a0)
    move.b %d1, 24(%a0)
    move.b %d2, 20(%a0)
    move.b %d1, 16(%a0)
    move.b %d2, 12(%a0)
    move.b %d1, 8(%a0)
    move.b %d2, 4(%a0)
    move.b %d1, 0(%a0)
.exit:
	move.l (%sp)+, %d2
	rts


vline_native_dither_skip:
	| vline_native_dither(u8* buf, s16 dy, u8 col1, u8 col2)
	move.l 4(%sp), %a0		| load pointer
	moveq.l #0, %d0
	move.w #79, %d0
	sub.w 10(%sp), %d0		| d0 is 79-dy
	move.b 15(%sp), %d1 	| load color 1
	move.l %d2, -(%sp)
	| move.b 4+19(%sp), %d2		| load color 2
	move.b %d1, %d2
    lsl.w #2, %d0
	jmp dither_draw_table_skip(%pc, %d0.W)


dither_draw_table_skip:
    move.b %d2, 632(%a0)
    move.b %d1, 624(%a0)
    move.b %d2, 616(%a0)
    move.b %d1, 608(%a0)
    move.b %d2, 600(%a0)
    move.b %d1, 592(%a0)
    move.b %d2, 584(%a0)
    move.b %d1, 576(%a0)
    move.b %d2, 568(%a0)
    move.b %d1, 560(%a0)
    move.b %d2, 552(%a0)
    move.b %d1, 544(%a0)
    move.b %d2, 536(%a0)
    move.b %d1, 528(%a0)
    move.b %d2, 520(%a0)
    move.b %d1, 512(%a0)
    move.b %d2, 504(%a0)
    move.b %d1, 496(%a0)
    move.b %d2, 488(%a0)
    move.b %d1, 480(%a0)
    move.b %d2, 472(%a0)
    move.b %d1, 464(%a0)
    move.b %d2, 456(%a0)
    move.b %d1, 448(%a0)
    move.b %d2, 440(%a0)
    move.b %d1, 432(%a0)
    move.b %d2, 424(%a0)
    move.b %d1, 416(%a0)
    move.b %d2, 408(%a0)
    move.b %d1, 400(%a0)
    move.b %d2, 392(%a0)
    move.b %d1, 384(%a0)
    move.b %d2, 376(%a0)
    move.b %d1, 368(%a0)
    move.b %d2, 360(%a0)
    move.b %d1, 352(%a0)
    move.b %d2, 344(%a0)
    move.b %d1, 336(%a0)
    move.b %d2, 328(%a0)
    move.b %d1, 320(%a0)
    move.b %d2, 312(%a0)
    move.b %d1, 304(%a0)
    move.b %d2, 296(%a0)
    move.b %d1, 288(%a0)
    move.b %d2, 280(%a0)
    move.b %d1, 272(%a0)
    move.b %d2, 264(%a0)
    move.b %d1, 256(%a0)
    move.b %d2, 248(%a0)
    move.b %d1, 240(%a0)
    move.b %d2, 232(%a0)
    move.b %d1, 224(%a0)
    move.b %d2, 216(%a0)
    move.b %d1, 208(%a0)
    move.b %d2, 200(%a0)
    move.b %d1, 192(%a0)
    move.b %d2, 184(%a0)
    move.b %d1, 176(%a0)
    move.b %d2, 168(%a0)
    move.b %d1, 160(%a0)
    move.b %d2, 152(%a0)
    move.b %d1, 144(%a0)
    move.b %d2, 136(%a0)
    move.b %d1, 128(%a0)
    move.b %d2, 120(%a0)
    move.b %d1, 112(%a0)
    move.b %d2, 104(%a0)
    move.b %d1, 96(%a0)
    move.b %d2, 88(%a0)
    move.b %d1, 80(%a0)
    move.b %d2, 72(%a0)
    move.b %d1, 64(%a0)
    move.b %d2, 56(%a0)
    move.b %d1, 48(%a0)
    move.b %d2, 40(%a0)
    move.b %d1, 32(%a0)
    move.b %d2, 24(%a0)
    move.b %d1, 16(%a0)
    move.b %d2, 8(%a0)
    move.b %d1, 0(%a0)
	move.l (%sp)+, %d2
	rts
